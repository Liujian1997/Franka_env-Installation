# DDOM 推导

> 关于提到的概念，均取自WiKi百科
> 
## 1. 先验、后验、似然、证据

### 1.1 先验分布

- 先验：在贝叶斯统计中，某一不确定量p的先验概率分布是在考虑"观测数据"前，能表达p不确定性的概率分布。$$P(\theta)$$

- 后验：在贝叶斯统计中，一个随机事件或者一个不确定事件的后验概率是在考虑和给出相关证据或数据后所得到的条件概率。同样，后验概率分布是一个未知量（视为随机变量）基于试验和调查后得到的概率分布。$$P(\theta|X)$$

- 似然：在数理统计学中，似然函数是一种关于统计模型中的参数的函数，表示模型参数中的似然性。给定输出 $x$ 时，关于参数 $\theta$ 的似然函数 $L(\theta|x)$（在数值上）等于给定参数 $\theta$ 后变量 $X$ 的概率：$L(\theta|x)=P(X=x|\theta)$ 。

- 证据（evidence）：是似然函数的积分，表示在所有参数上，给定数据 $x$ 的概率。证据通常记为 $P(x)$ 或 $Z$ 。在贝叶斯统计中，证据可以用来计算后验分布。$$P(X)$$

$P_{\theta}(x)$ 是什么？

$P_{\theta}(x) = P(x|\theta)$ ,其中 $P(\theta)$ 是先验，$x$ 是观测值。但对于VAE来说：

- 先验是 $P_{\theta}(z)$ , z是隐变量。
- 后验是 $P_{\theta}(z|x)$ 。
- 似然**值**是 $P_{\theta}(x|z)$ ，为什么值要加粗呢，似然是 $L(z|x)=P_{\theta}(x|z)$

为什么上述 $\theta$ 可以写在外边呢，因为**链式法则**：

$$
P(x,z|\theta) = P(x|z,\theta)P(z|\theta) = P(x|z,\theta)P(z|\theta) = P(x|\theta)P(z|\theta)
$$
### 1.2 分布

图像分布：高维概率分布，例如，手写数字识别中有$28 \times 28 = 784$，则有$784$维的分布。

## 2. VAE

### 2.1 VAE目标

VAE是一种生成模型，简单来说就是一个联合概率分布$P(X)$。有了这个分布之后就可以采用生成不同的样本。

### 2.2 VAE预备知识——极大似然估计

极大似然估计假设给定一组观测值采样服从独立同分布，因此联合概率分布可以分解为：$$L(\theta|X) = P(X|\theta) = \prod_{i=1}^np(x_i|\theta)$$

极大似然估计可以写为以下内容，取对数是为了连乘便加号便于计算：
$$\hat{\theta} =\argmax \sum_{i=1}^n\ln(x_i|\theta)$$

$$\nabla_{\theta}L(\theta|X) = \nabla_{\theta} \sum_{i=1}^n\ln(x_i|\theta)= \sum_{i=1}^n\nabla_{\theta}\ln(x_i|\theta)$$